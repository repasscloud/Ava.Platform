# Use .NET SDK to run migrations
FROM mcr.microsoft.com/dotnet/sdk:9.0 AS build
WORKDIR /app

# Copy project files
COPY . .

# Restore dependencies
RUN dotnet restore

# Install EF Core CLI tool
RUN dotnet tool install --global dotnet-ef

# Ensure dotnet tools are available in PATH
ENV PATH="$PATH:/root/.dotnet/tools"

# Run the migrations when the container starts
ENTRYPOINT ["dotnet", "ef", "database", "update"]
